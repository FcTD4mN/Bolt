CMAKE_MINIMUM_REQUIRED(VERSION 3.6)
CMAKE_POLICY(SET CMP0054 NEW)

# Project name
PROJECT(Bolt C CXX)

set(CMAKE_CXX_STANDARD 17)

set(CMAKE_MODULE_PATH ${CMAKE_CURRENT_LIST_DIR}/cmake ${CMAKE_MODULE_PATH})
set(CMAKE_MODULE_PATH ${CMAKE_CURRENT_LIST_DIR}/cmake/modules ${CMAKE_MODULE_PATH})

set(INCLUDE_DIRECTORIES "")
set(LINK_LIBS "")

FIND_PACKAGE(Threads REQUIRED)
SET(INCLUDE_DIRECTORIES ${INCLUDE_DIRECTORIES} ${Threads_INCLUDE_DIRS})
SET(LINK_LIBS ${LINK_LIBS} ${CMAKE_THREAD_LIBS_INIT})
message("Includes : ${Threads_INCLUDE_DIRS}")
message("Libraries: ${CMAKE_THREAD_LIBS_INIT}")

FIND_PACKAGE(GLM REQUIRED)
set( INCLUDE_DIRECTORIES ${INCLUDE_DIRECTORIES} ${GLM_INCLUDE_DIRS})
message("Includes : ${GLM_INCLUDE_DIRS}")
message("Libraries: ")

FIND_PACKAGE(OpenGL REQUIRED)
set( INCLUDE_DIRECTORIES ${INCLUDE_DIRECTORIES} ${OPENGL_INCLUDE_DIR})
set( LINK_LIBS ${LINK_LIBS} ${OPENGL_LIBRARIES})
message("Includes : ${OPENGL_INCLUDE_DIR}")
message("Libraries: ${OPENGL_LIBRARIES}")

FIND_PACKAGE(GLEW REQUIRED)
set( INCLUDE_DIRECTORIES ${INCLUDE_DIRECTORIES} ${GLEW_INCLUDE_DIR})
set( LINK_LIBS ${LINK_LIBS} ${GLEW_LIBRARIES})
message("Includes : ${GLEW_INCLUDE_DIR}")
message("Libraries: ${GLEW_LIBRARIES}")

FIND_PACKAGE(PythonLibs REQUIRED)
set( INCLUDE_DIRECTORIES ${INCLUDE_DIRECTORIES} ${PYTHON_INCLUDE_DIR})
set( LINK_LIBS ${LINK_LIBS} ${PYTHON_LIBRARIES})
message("Includes : ${SFML_INCLUDE_DIR}")
message("Libraries: ${SFML_LIBRARIES}")

FIND_PACKAGE(TinyXML2 REQUIRED)
set( INCLUDE_DIRECTORIES ${INCLUDE_DIRECTORIES} ${TINYXML2_INCLUDE_DIR})
set( LINK_LIBS ${LINK_LIBS} ${TINYXML2_LIBRARIES})
message("Includes : ${TINYXML2_INCLUDE_DIR}")
message("Libraries: ${TINYXML2_LIBRARIES}")

FIND_PACKAGE(SFML REQUIRED network audio graphics window system)
set( INCLUDE_DIRECTORIES ${INCLUDE_DIRECTORIES} ${SFML_INCLUDE_DIR})
set( LINK_LIBS ${LINK_LIBS} ${SFML_LIBRARIES} ${SFML_DEPENDENCIES})
message("Includes : ${SFML_INCLUDE_DIR}")
message("Libraries: ${SFML_LIBRARIES}")


FILE(GLOB_RECURSE SRC_FILES RELATIVE "${CMAKE_SOURCE_DIR}" "${CMAKE_SOURCE_DIR}/src/*.cpp")
FILE(GLOB_RECURSE HEADER_FILES RELATIVE "${CMAKE_SOURCE_DIR}" "${CMAKE_SOURCE_DIR}/src/*.h*")

LIST(FILTER SRC_FILES EXCLUDE REGEX ".*Editor.*")
LIST(FILTER HEADER_FILES EXCLUDE REGEX ".*Editor.*")

set(header_directories "")
foreach(header in ${HEADER_FILES})
    get_filename_component(tmp ${header} DIRECTORY)
    list( APPEND header_directories ${tmp})
endforeach(header in ${HEADER_FILES})
list(REMOVE_DUPLICATES header_directories)
set( INCLUDE_DIRECTORIES ${INCLUDE_DIRECTORIES} ${header_directories})


SET_SOURCE_FILES_PROPERTIES(HEADER_FILES PROPERTIES HEADER_FILE_ONLY TRUE)
ADD_EXECUTABLE(${PROJECT_NAME} ${SRC_FILES} ${HEADER_FILES})
target_compile_options(${PROJECT_NAME} PUBLIC "-std=c++17")
TARGET_INCLUDE_DIRECTORIES(${PROJECT_NAME} PRIVATE ${INCLUDE_DIRECTORIES} ${HEADER_FILES})
TARGET_LINK_LIBRARIES(${PROJECT_NAME} ${LINK_LIBS} "stdc++fs")

